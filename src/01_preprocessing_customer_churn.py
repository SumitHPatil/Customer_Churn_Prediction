# -*- coding: utf-8 -*-
"""Preprocessing_customer_churn.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1CmYaCJO-emnqQ4hztZYW2yFY3fLQM2OZ

**1.Loading the prerequisites**
"""

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.preprocessing import LabelEncoder
from imblearn.over_sampling import SMOTE
from sklearn.model_selection import train_test_split,cross_val_score
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from xgboost import XGBClassifier
from sklearn.metrics import accuracy_score,confusion_matrix,classification_report

"""**2.Loading and understanding dataset**"""

df = pd.read_csv("/content/Raw_Customer-Churn.csv")

df.head()

df.info()

"""**3.Data preprocessing**"""

df = df.drop(columns=["customerID"])

df.head()

df.columns

# printing unique values from each column
for col in df.columns:
  print(col,df[col].unique())
  print("-"*50)

print(df.isnull().sum())

df[df["TotalCharges"]==" "]

len(df[df["TotalCharges"]==" "])

#replacing and converting string to float
df["TotalCharges"]=df["TotalCharges"].replace({" ":"0.0"})
df["TotalCharges"]=df["TotalCharges"].astype(float)

#checking class distribution of target col
print(df["Churn"].value_counts())
print("so it is imbalanced")

"""### **Insights**



1. CustomerID removed as it was not important.
2. Totalcharges columns's missing values is replaced with '0'(zero) and changed its data type to float.
3. No missing values in the dataset.
4. Class imbalance found in target column i.e "Churn"




"""

df.to_csv('Customer-Churn-cleaned.csv', index=False)
print("Cleaned DataFrame saved to 'Customer-Churn-cleaned.csv'")